<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66582-32"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-66582-32');
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Convolution Hyperparameters" />
<meta property="og:description" content="Motivation Our initial convolution intuition was built on the notion of a filter that scanned over an image extracting relevant features and reducing dimensionality into the next layers.
from IPython.display import Image Image(&#39;images/conv_sliding.png&#39;) However, applying similar filters in subsequent layers would create a telescoping effect where basically hack-and-slash away at the dimension of our data until there&rsquo;s nothing left in the final layers.
Thankfully, there are hyperparameters we can employ to correct for this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://napsterinblue.github.io/notes/machine_learning/computer_vision/conv_hyperparams/" />



<meta property="article:published_time" content="2018-09-24T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-09-24T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Convolution Hyperparameters"/>
<meta name="twitter:description" content="Motivation Our initial convolution intuition was built on the notion of a filter that scanned over an image extracting relevant features and reducing dimensionality into the next layers.
from IPython.display import Image Image(&#39;images/conv_sliding.png&#39;) However, applying similar filters in subsequent layers would create a telescoping effect where basically hack-and-slash away at the dimension of our data until there&rsquo;s nothing left in the final layers.
Thankfully, there are hyperparameters we can employ to correct for this."/>
<meta name="generator" content="Hugo 0.40.3" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Convolution Hyperparameters",
  "url": "https://napsterinblue.github.io/notes/machine_learning/computer_vision/conv_hyperparams/",
  "wordCount": "337",
  "datePublished": "2018-09-24T00:00:00&#43;00:00",
  "dateModified": "2018-09-24T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": ""
  }
}
</script> 

    <title>Convolution Hyperparameters</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://napsterinblue.github.io/notes/css/custom.css" rel="stylesheet">
    <link href="https://napsterinblue.github.io/notes/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">

    <link href="" rel="alternate" type="application/rss+xml" title="Data Science Notes" />

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://napsterinblue.github.io">Movies, Metrics, Musings</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="nav navbar-nav">
                    <li><a href="https://napsterinblue.github.io/pages/about.html" title="About">About</a></li>
                    <li><a href="https://napsterinblue.github.io/archives.html" title="Archive">Archive</a></li>
                    <li><a href="https://napsterinblue.github.io/pages/resources.html" title="Resources">Resources</a></li>
                    <li><a href="https://napsterinblue.github.io/notes/" title="Notes">My Notes</a></li>

                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                 


<article>
  <div class="technical_note">
  <header>
    <h1 class="technical_note_title">Convolution Hyperparameters</h1>
    <div class="technical_note_date">
      <time datetime=" 2018-09-24T00:00:00Z "> 24 Sep 2018</time>
    </div>
  </header>
  <div class="content">
  

<h2 id="motivation">Motivation</h2>

<p>Our initial convolution intuition was built on the notion of a filter that scanned over an image extracting relevant features and reducing dimensionality into the next layers.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s1">&#39;images/conv_sliding.png&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="conv_hyperparams_3_0.png" alt="png" /></p>

<p>However, applying similar filters in subsequent layers would create a telescoping effect where basically hack-and-slash away at the dimension of our data until there&rsquo;s nothing left in the final layers.</p>

<p>Thankfully, there are hyperparameters we can employ to correct for this.</p>

<h3 id="padding">Padding</h3>

<p>By padding the outside of our original image with a bunch of zeros, we can fit more unique windows of the same size in our vertical and horizontal passes.</p>

<p>This still gives us all of the same information as before, but also has the added benefit of letting us use information found at the edges of our image, too.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;images/padding.png&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="conv_hyperparams_7_0.png" alt="png" /></p>

<p>There are two types of filter padding schemes:</p>

<ul>
<li><strong>Valid</strong>: Any value <code>f &lt; n</code> that allows us to scan over the data</li>
<li><strong>Same</strong>: Pad so that the output size is the same as the input size</li>
</ul>

<p>To achieve <strong>Same</strong> padding, we want to choose <code>pad</code> value equal to</p>

<p>$p = \frac{f-1}{2}$</p>

<h3 id="stride">Stride</h3>

<p>The other lever we can pull to adjust the size of our convolution output is stride, or the step size that we use when traversing the image vertically and horizontally with our filter.</p>

<p>Obviously a bigger stride means that we&rsquo;ve got less room to move about, thus resulting in a smaller output-shape of our convolution.</p>

<h3 id="output-shape">Output Shape</h3>

<p>Generally, given</p>

<ul>
<li><code>n</code>, the input shape</li>
<li><code>p</code>, padding</li>
<li><code>f</code>, the size of your filter</li>
<li><code>s</code>, stride</li>
</ul>

<p>we can calculate the <code>z x z</code> dimension of our output shape with the following</p>

<p>$\lfloor \frac{n+2p-f}{s} + 1 \rfloor$</p>

<h2 id="multiple-filters">Multiple Filters</h2>

<p>Lastly, we can create multiple filters to try and discern different features from our original image. They both do their convolution steps independently, then are concatenated into a multi-dimensional matrix before getting passed into the next layer.</p>

<p>Remember&ndash; you must ensure that the final dimension of your filters are compatible with your input data.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;images/conv_layers.png&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="conv_hyperparams_15_0.png" alt="png" /></p>

</div>
  <aside>
      <div class="bug_reporting">
          <h4>Find an error or bug?</h4>
          <p>Everything on this site is available on GitHub. Head to <a href='https://github.com/napsterinblue/notes/issues/new'>and submit a suggested change</a>. You can also message me directly on <a href='https://twitter.com/napsterinblue'>Twitter</a>.</p>
      </div>
      </aside>

    </div>
</article>




            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 185 pages and is available on <a href="https://github.com/napsterinblue/notes">GitHub</a>. Copyright &copy; NapsterInBlue, <time datetime="2018">2018</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>
