<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66582-32"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-66582-32');
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Random Search and Appropriate Search-Space Scaling" />
<meta property="og:description" content="Grid search isn&rsquo;t always our best approach for figuring out our best hyperparameters.
In the example of Deep Learning and Adam Optimization, there are several different hyperparameters to consider. Some, like the alpha constant, need tuning. On the other hand, constants like epsilon are basically taken as granted and don&rsquo;t affect the model.
from IPython.display import Image Image(&#39;images/feature_grid.PNG&#39;) By grid searching over any feature space that includes epsilon, we&rsquo;re putting five times the computation on our system for less-than-negligible performance gain." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://napsterinblue.github.io/notes/machine_learning/model_selection/random_search/" />



<meta property="article:published_time" content="2018-09-05T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-09-05T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Random Search and Appropriate Search-Space Scaling"/>
<meta name="twitter:description" content="Grid search isn&rsquo;t always our best approach for figuring out our best hyperparameters.
In the example of Deep Learning and Adam Optimization, there are several different hyperparameters to consider. Some, like the alpha constant, need tuning. On the other hand, constants like epsilon are basically taken as granted and don&rsquo;t affect the model.
from IPython.display import Image Image(&#39;images/feature_grid.PNG&#39;) By grid searching over any feature space that includes epsilon, we&rsquo;re putting five times the computation on our system for less-than-negligible performance gain."/>
<meta name="generator" content="Hugo 0.40.3" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Random Search and Appropriate Search-Space Scaling",
  "url": "https://napsterinblue.github.io/notes/machine_learning/model_selection/random_search/",
  "wordCount": "463",
  "datePublished": "2018-09-05T00:00:00&#43;00:00",
  "dateModified": "2018-09-05T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": ""
  }
}
</script> 

    <title>Random Search and Appropriate Search-Space Scaling</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://napsterinblue.github.io/notes/css/custom.css" rel="stylesheet">
    <link href="https://napsterinblue.github.io/notes/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">

    <link href="" rel="alternate" type="application/rss+xml" title="Data Science Notes" />

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://napsterinblue.github.io">Movies, Metrics, Musings</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="nav navbar-nav">
                    <li><a href="https://napsterinblue.github.io/pages/about.html" title="About">About</a></li>
                    <li><a href="https://napsterinblue.github.io/archives.html" title="Archive">Archive</a></li>
                    <li><a href="https://napsterinblue.github.io/pages/resources.html" title="Resources">Resources</a></li>
                    <li><a href="https://napsterinblue.github.io/notes/" title="Notes">My Notes</a></li>

                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                 


<article>
  <div class="technical_note">
  <header>
    <h1 class="technical_note_title">Random Search and Appropriate Search-Space Scaling</h1>
    <div class="technical_note_date">
      <time datetime=" 2018-09-05T00:00:00Z "> 05 Sep 2018</time>
    </div>
  </header>
  <div class="content">
  

<p>Grid search isn&rsquo;t always our best approach for figuring out our best hyperparameters.</p>

<p>In the example of <a href="https://napsterinblue.github.io/notes/machine_learning/neural_nets/adam_opt/">Deep Learning and Adam Optimization, there are several different hyperparameters to consider</a>. Some, like the <code>alpha</code> constant, need tuning. On the other hand, constants like <code>epsilon</code> are basically taken as granted and don&rsquo;t affect the model.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">Image</span><span class="p">(</span><span class="s1">&#39;images/feature_grid.PNG&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="random_search_2_0.png" alt="png" /></p>

<p>By grid searching over any feature space that includes <code>epsilon</code>, we&rsquo;re putting <strong>five times the computation</strong> on our system for less-than-negligible performance gain.</p>

<p>Instead, Andrew Ng suggests doing a random search over the feature space to arrive at your coefficients. If instead, we did half the number of searches in a random fashion (below), we&rsquo;d still get the learnings from tuning <code>alpha</code>, without over-searching in the <code>epsilon</code> space.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;images/feature_grid_random.png&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="random_search_5_0.png" alt="png" /></p>

<p>But this presents a new, interesting problem.</p>

<p>Whereas something like <em>Number of Layers</em> or <em>Number of Hidden</em> units might make sense to sample from on a linear scale, not all coefficients behave this way.</p>

<p>For instance, adjusting our <code>alpha</code> constant between <code>0.05</code> and <code>0.06</code> likely has a bigger performance impact than adjusting between <code>0.5</code> and <code>0.6</code>, as it&rsquo;s often a low-valued number.</p>

<p>And so by sampling randomly on a linear scale between <code>0.0001</code> and and <code>1</code>, we spend as much compute resources investigating the upper-range values as the incremental, lower ones where the real optimization occurs.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;images/uniform_alpha.PNG&#39;</span><span class="p">)</span></code></pre></div>
<p><img src="random_search_8_0.png" alt="png" /></p>

<h2 id="scaling">Scaling</h2>

<p>Thus, determining the correct scaling mechanism for your hyperparameters is crucial. You want to scale, based on the class of the coefficient, which may include the following:</p>

<h3 id="linear">Linear</h3>

<p>This one&rsquo;s easy. We just want to do a uniform search between two values.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span></code></pre></div>
<pre><code>0.9358677626967968
</code></pre>

<h3 id="discrete">Discrete</h3>

<p>For whole-numbered values between two values, we&rsquo;ll use <code>randint()</code></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span></code></pre></div>
<pre><code>2
</code></pre>

<h3 id="log-scale">Log Scale</h3>

<p>For coefficients, like <code>alpha</code> above, where we want to select between a very small value and <code>1</code>, it&rsquo;s helpful to consider how to write it out as an exponent. For instance:</p>

<p>$0.0001 = 10^{-4}$</p>

<p>similarly</p>

<p>$1 = 10^{0}$</p>

<p>So this is actually just the same exercise as the Linear Scale, but between some negative number and <code>0</code>, then piped as an exponent!</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">min_exp</span><span class="p">,</span> <span class="n">max_exp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span>

<span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">min_exp</span><span class="p">,</span> <span class="n">max_exp</span><span class="p">)</span>
<span class="mi">10</span> <span class="o">**</span> <span class="n">val</span></code></pre></div>
<pre><code>0.00305918793992655
</code></pre>

<h3 id="exponentially-weighted">Exponentially Weighted</h3>

<p>This would likely be better-named as &ldquo;Reverse Log Scale,&rdquo; describing hyperparameters where your search space is most effective between, say, <code>0.9</code> and <code>0.999</code>, on a Log-ish scale.</p>

<p>Following the same approach as above, we just want to do a uniform search over the correct range of values, plus some other steps&ndash; in this case, establishing a log log scale for <code>0.9</code> to <code>0.999</code> involves establishing a log scale for <code>0.0001</code> to <code>0.1</code> and subtracting that from <code>1</code></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">min_exp</span><span class="p">,</span> <span class="n">max_exp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">min_exp</span><span class="p">,</span> <span class="n">max_exp</span><span class="p">)</span>
<span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">val</span><span class="p">)</span></code></pre></div>
<pre><code>0.9908195535776579
</code></pre>

</div>
  <aside>
      <div class="bug_reporting">
          <h4>Find an error or bug?</h4>
          <p>Everything on this site is available on GitHub. Head to <a href='https://github.com/napsterinblue/notes/issues/new'>and submit a suggested change</a>. You can also message me directly on <a href='https://twitter.com/napsterinblue'>Twitter</a>.</p>
      </div>
      </aside>

    </div>
</article>




            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 185 pages and is available on <a href="https://github.com/napsterinblue/notes">GitHub</a>. Copyright &copy; NapsterInBlue, <time datetime="2018">2018</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>
